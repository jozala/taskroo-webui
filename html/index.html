<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../bower_components/bootstrap-switch/build/css/bootstrap3/bootstrap-switch.min.css"/>
    <link rel="stylesheet" href="../style/tabular-list.css"/>
    <link rel="stylesheet" href="../style/main.css"/>

    <title>GTWeb - New Better Best</title>
</head>
<body>


<div class="main-window" ng-app="GTWeb">
    <nav id="left-sidebar" >
        <form id="search-form" ng-controller="SearchCtrl">
            <input type="text" placeholder="Search" id="search-field" class="input" ng-model="search.searchString"/>
            <input type="submit" id="search-button" class="input" value="" />
        </form>
        <div style="clear: both;"></div>
        <div class="tags-box" ng-controller="TagsCtrl">
            <ul class="tags-list">
                <tag name="All tags" ng-class="{'active-tag': tagFilter.selectedTag == 'ALL'}" ng-click="selectTag('ALL')">All tags</tag>
                <tag name="Tasks without tags" ng-class="{'active-tag': tagFilter.selectedTag == 'NONE'}" ng-click="selectTag('NONE')">Tasks without tags</tag>
                <tag ng-class='{"active-tag": tag.selected}' ng-repeat="tag in tags" ng-model="tag" context-menu-toggle="#tag-edit-context-menu-{{ tag.id }}" ng-click="selectTag(tag)" >
                    {{ tag.name }}
                    <div class="tag-edit-context-menu" id="tag-edit-context-menu-{{ tag.id }}">
                        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
                            <li><a tabindex="-1" href="#" ng-click="editTag(tag)">Edit tag</a></li>
                            <li><a tabindex="-1" href="#" ng-click="removeTag(tag)">Remove tag</a></li>
                        </ul>
                    </div>
                </tag>

            </ul>
        </div>
    </nav>
    <section id="body" ng-controller="TasksCtrl">
        <div>
            <div id="top-bar">
                <form id="add-task-form" class="top-box" name="task" action="" method="POST" accept-charset="utf-8"
                      ng-submit="magicInputSubmit()">
                    <input placeholder="What about creating a new task?" focus-element type="text" name="taskInput" ng-model="magicInput"/>
                    <input type="submit" value="Add" class="btn btn-warning"/>
                </form>

                <div id="view-bar" class="top-box btn-group">
                    <button type="button" ng-model="workview" class="btn btn-warning btn-workview" btn-checkbox>
                        Work View
                    </button>
                    <button class="btn btn-warning dropdown-toggle" data-toggle="dropdown">
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li id="show-finished-tasks-button" ng-show="showUnfinished" ng-click="showUnfinished = false"><a href="#">Show finished tasks</a></li>
                        <li id="show-unfinished-tasks-button" ng-hide="showUnfinished" ng-click="showUnfinished = true"><a href="#">Show unfinished tasks</a></li>
                    </ul>
                </div>

            </div>

            <!-- Nested list template -->
            <script type="text/ng-template" id="table_renderer.html">
                <span>
                    <cell class="taskTick" ng-click="taskFinished(task)"></cell>
                    <cell class='taskTags'><tag-icon ng-repeat='tag in task.tags' ng-model="tag"></tag-icon></cell>
                    <cell class="taskTitle main-column" quick-edit ng-model="task.title" ng-change="updateTask(task)">{{ task.title }}</cell>
                    <cell ng-if="!task.finished" class="taskDueDate">{{ task.dueDate | date: 'dd-MM-yyyy' }}</cell>
                    <cell ng-if="task.finished" class="taskDueDate">{{ task.closedDate | date: 'dd-MM-yyyy' }}</cell>
                    <cell class="taskAction taskEdit" ng-click="openEdit(task)"></cell>
                    <cell class="taskAction taskSubtask" ng-click="openCreateSubtask(task); expand()"></cell>
                    <cell class="taskAction taskDel" ng-click="removeTask(task)"></cell>
                </span>
                <div>
                    <tablist>
                        <row ng-repeat="task in task.subtasks | orderBy:tasksOrderPredicate:false | filter:searchTask" ng-class="{'taskFinished': task.finished}" ng-include="'table_renderer.html'"
                             droppable="task.subtasks" draggable="task">
                        </row>
                    </tablist>
                </div>
            </script>

            <div class="box">
                <tablist indent="15" expanded="false">
                    <li droppable="tasks" style="height: 10px;"></li>
                    <row ng-repeat="task in tasks | orderBy:tasksOrderPredicate:false | filter:searchTask" ng-class="{'taskFinished': task.finished}"
                         droppable="task.subtasks" draggable="task" ng-include="'table_renderer.html'">
                    </row>
                    <li droppable="tasks" style="height: 10px;"></li>
                </tablist>
            </div>
        </div>
    </section>
</div>
<footer>
    
</footer>


<!-- TODO testdata.js should be removed before release -->
<script type="text/javascript" src="../js/testdata.js"></script>
<script type="text/javascript" src="../bower_components/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../bower_components/angular/angular.min.js"></script>
<script type="text/javascript" src="../bower_components/jquery-ui/ui/minified/jquery-ui.min.js"></script>
<script type="text/javascript" src="../bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
<script type="text/javascript" src="../js/main.js"></script>
<script type="text/javascript" src="../js/tags.js"></script>
<script type="text/javascript" src="../js/tasks.js"></script>
<script type="text/javascript" src="../js/search.js"></script>
<script type="text/javascript" src="../js/magic-input-parser.js"></script>
<script type="text/javascript" src="../bower_components/tabularlist/js/tablist.js"></script>
<script type="text/javascript" src="../bower_components/momentjs/min/moment.min.js"></script>
<script type="text/javascript" src="../js/bootstrap-contextmenu.js"></script>
<script type="text/javascript" src="../bower_components/bootstrap-switch/build/js/bootstrap-switch.min.js"></script>
<script type="text/javascript" src="../bower_components/angular-bootstrap-switch/dist/angular-bootstrap-switch.min.js"></script>

</body>
</html>